package meal;

import util.DBUtil;
import java.util.Map;
import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class User_Edit
 */
@WebServlet("/user_edit")
public class User_Edit extends HttpServlet {
	private static final long serialVersionUID = 1L;

	/**
	 * @see HttpServlet#HttpServlet()
	 */
	public User_Edit() {
		super();
		// TODO Auto-generated constructor stub
	}

	/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse
	 *      response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {

		response.setContentType("text/html;charset=utf-8");
		PrintWriter out = response.getWriter();
		request.setCharacterEncoding("utf-8");

//		out.println("<h1>yes</h1>");

		String id = (String) request.getSession().getAttribute("id");
		String sql = "select * from user where id =?";
		String[] params = { id };

		Map<String, String> u = new DBUtil().getMap(sql, params);
		request.setAttribute("user", u);
		// 请求转发到user_edit.jsp
		

		if (u != null) {
			out.println("<!doctype html>\r\n" + "<html lang=\"en\">\r\n" + "\r\n" + "<head>\r\n"
					+ "  <title>管理员添加菜品信息</title>\r\n" + "  <!-- Required meta tags -->\r\n"
					+ "  <meta charset=\"utf-8\">\r\n"
					+ "  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\r\n"
					+ "\r\n" + "  <!-- 新 Bootstrap4 核心 CSS 文件 -->\r\n"
					+ "  <link rel=\"stylesheet\" href=\"./resources/WebContent/bootstrap/css/bootstrap.min.css\">\r\n"
					+ "\r\n" + "  <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->\r\n"
					+ "  <script src=\"./resources/WebContent/jquery/jquery-3.6.0.min.js\"></script>\r\n" + "\r\n"
					+ "  <!-- 最新的 Bootstrap4 核心 JavaScript 文件 -->\r\n"
					+ "  <script src=\"./resources/WebContent/bootstrap/js/bootstrap.bundle.min.js\"></script>\r\n"
					+ "\r\n" + "</head>\r\n" + "\r\n" + "<body>\r\n" + "  <!-- 导航头 -->\r\n"
					+ "  <div class=\"container-fluid\">\r\n" + "    <div class=\"row\">\r\n"
					+ "      <div class=\"col-md-12\">\r\n" + "\r\n"
					+ "        <nav class=\"navbar navbar-expand-lg navbar-light bg-light\">\r\n" + "\r\n"
					+ "          <button class=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\"\r\n"
					+ "            data-target=\"#bs-example-navbar-collapse-1\">\r\n"
					+ "            <span class=\"navbar-toggler-icon\"></span>\r\n" + "          </button>\r\n"
					+ "          <a class=\"navbar-brand\" href=\"admin_index.html\"><span class=\"text-info\">网络点餐系统</span></a>\r\n"
					+ "          <div class=\"collapse navbar-collapse\" id=\"bs-example-navbar-collapse-1\">\r\n"
					+ "            <ul class=\"navbar-nav\">\r\n" + "              <li class=\"nav-item\">\r\n"
					+ "                <a class=\"nav-link\" href=\"user_index.html\">正在点餐</a>\r\n"
					+ "              </li>\r\n" + "              <li class=\"nav-item active\">\r\n"
					+ "                <a class=\"nav-link\" href=\"user_dc_show.html\">我的点餐</a>\r\n"
					+ "              </li>\r\n" + "            </ul>\r\n" 
					+ "\r\n"
					+ "            <ul class=\"navbar-nav ml-md-auto\">\r\n"
					+ "              <li class=\"nav-item dropdown\">\r\n"
					+ "                <a class=\"nav-link dropdown-toggle\" data-toggle=\"dropdown\">"
					+ request.getSession().getAttribute("用户名") 
					+ "</a>\r\n"
					+ "                <div class=\"dropdown-menu dropdown-menu-right\">\r\n"
					+ "                  <a class=\"dropdown-item\" href=\"#\">修改个人资料</a>\r\n"
					+ "                  <div class=\"dropdown-divider\"></div>\r\n"
					+ "                  <a class=\"dropdown-item\" href=\"homepage.html\">退出登录</a>\r\n"
					+ "                </div>\r\n" + "              </li>\r\n" + "            </ul>\r\n"
					+ "          </div>\r\n" + "        </nav>\r\n" + "\r\n" + "      </div>\r\n" + "    </div>\r\n"
					+ "  </div>\r\n" + "\r\n" + "  <div class=\"container-fluid\">\r\n" + "    <div class=\"row\">\r\n"
					+ "\r\n" + "      <div class=\"col-md-2\">\r\n" + "      </div>\r\n" + "\r\n"
					+ "      <div class=\"col-md-8\">\r\n"
					+ "        <div class=\"card bg-default border-warning\">\r\n" + "          <!-- 卡片  -->\r\n"
					+ "          <h5 class=\"card-header bg-warning text-center text-white\">\r\n"
					+ "            修改个人资料\r\n" + "          </h5>\r\n"
					+ "          <form role=\"form\" method=\"POST\" action=\"user_update\">\r\n"
					+ "            <div class=\"card-body\">\r\n" + "\r\n"
					+ "              <div class=\"form-group\">\r\n" + "                <label>\r\n"
					+ "                  用户名称\r\n" + "                </label>\r\n"
					+ "                <div class=\"alert alert-success\">" + request.getSession().getAttribute("用户名")
					+ "</div>\r\n" + "              </div>\r\n" + "              <div class=\"form-group\">\r\n"
					+ "                <label>\r\n" + "                  密码\r\n" + "                </label>\r\n"
					+ "                <input type=\"password\" class=\"form-control\" name=\"passworld\" required value=\""
					+ u.get("passworld") + "\"/>\r\n" + "              </div>\r\n"
					+ "              <div class=\"form-group\">\r\n" + "                <label>\r\n"
					+ "                  电话\r\n" + "                </label>\r\n"
					+ "                <input type=\"text\" class=\"form-control\" name=\"tel\" value=\""
					+ u.get("telephone") + "\" required />\r\n" + "              </div>\r\n"
					+ "              <div class=\"form-group\">\r\n" + "                <label>\r\n"
					+ "                  地址\r\n" + "                </label>\r\n"
					+ "                <input type=\"text\" class=\"form-control\" name=\"address\" value=\""
					+ u.get("address") + "\" required />\r\n" + "              </div>\r\n" + "            </div>\r\n"
					+ "            <div class=\"card-footer text-center\">\r\n"
					+ "              <button type=\"submit\" class=\"btn btn-warning\">\r\n"
					+ "                确认添加\r\n" + "              </button>\r\n" + "              &nbsp;&nbsp;\r\n"
					+ "              <a href=\"javascript:history.back()\">\r\n" + "                放弃取消\r\n"
					+ "              </a>\r\n" + "            </div>\r\n" + "          </form>\r\n"
					+ "        </div>\r\n" + "      </div>\r\n" + "\r\n" + "      <div class=\"col-md-2\">\r\n"
					+ "      </div>\r\n" + "\r\n" + "    </div>\r\n" + "  </div>\r\n" + "\r\n" + "</body>\r\n" + "\r\n"
					+ "</html>");
		}
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse
	 *      response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		// TODO Auto-generated method stub
		doGet(request, response);
	}

}
